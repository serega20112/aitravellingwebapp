# Тестирование

## Структура тестов
Тесты находятся в `src/backend/tests/` и разделены по типам:
- `unit/` — юнит-тесты с изоляцией от инфраструктуры. Используют моки портов, DummyUoW, DummyAI.
- `integration/` — интеграционные тесты, поднимающие Flask app через тестовый клиент.

В `tests/conftest.py` находятся общие фикстуры: создание Flask приложения, клиента, двойники (DummyUoW, DummyAI), подмена сервисов для интеграции.

## Запуск тестов
```
pytest -q
```
Для отчёта о покрытии (если установлен pytest-cov):
```
pytest --cov=src/backend --cov-report=term-missing
```

## Подсказки
- Юнит-тесты не должны тянуть тяжёлые зависимости (torch/transformers). Используйте заглушки.
- Интеграции по возможности изолируйте от внешних сетевых вызовов.
- Для сценариев с БД удобно использовать SQLite in-memory + SQLAlchemyUnitOfWork, если нужны интеграционные тесты уровня репозиториев.
